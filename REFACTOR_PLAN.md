# UNION Match マッチング後フロー刷新計画

## 現状の問題点

1. **連絡先情報のみ**: 連絡先が書いてあるだけで、トラッキングできない
2. **完了フローの問題**: 企業側が完了ボタンを押してからレーティングという流れが不自然
3. **コミュニケーションの一元化不足**: 外部ツール（メール等）に依存している

## 改善方針（タイミー風UX）

### Phase 1: チャット機能の実装（最優先）

**目的**: プラットフォーム内で企業と学生が直接やり取りできるようにする

**実装内容**:
- プロジェクトごとのチャットルーム
- リアルタイムメッセージ送受信（Supabase Realtime）
- メッセージ履歴の表示
- 既読管理（Phase 2で実装）

**技術スタック**:
- Supabase Realtime
- Next.js API Routes
- React Hooks

**工数**: 約1週間

**コスト**: $0/月（無料プラン）または $25/月（Proプラン）

### Phase 2: 進捗トラッキング機能

**目的**: プロジェクトの進捗を可視化し、双方が確認できるようにする

**実装内容**:
- 簡易マイルストーン機能
  - 進捗ポイントの設定（企業側）
  - 進捗状況の更新（学生側）
  - 進捗率の表示
- 納品物の提出・確認機能
  - ファイル提出（学生側）
  - 確認・承認（企業側）
  - 修正依頼機能

**工数**: 約1週間

### Phase 3: 完了フローの改善

**目的**: 双方が完了を確認してから評価に進む流れに変更

**実装内容**:
- 双方の完了確認機能
  - 学生側: 「作業完了」ボタン
  - 企業側: 「納品確認完了」ボタン
  - 双方が完了を確認したら「評価可能」状態に
- 評価プロセスの改善
  - 完了後に自動的に評価画面へ誘導
  - 評価完了まで完了状態を維持

**工数**: 約3-5日

### Phase 4: 通知機能

**目的**: 新着メッセージや進捗更新を通知

**実装内容**:
- アプリ内通知
- メール通知（オプション）
- プッシュ通知（将来対応）

**工数**: 約3-5日

## 実装順序

1. **Phase 1（チャット機能）**: 最優先で実装
2. **Phase 3（完了フロー改善）**: チャット機能と並行して実装可能
3. **Phase 2（進捗トラッキング）**: Phase 1完了後に実装
4. **Phase 4（通知機能）**: 最後に実装

## データベーススキーマ変更

### 新規テーブル

1. **messages** (チャットメッセージ)
   - id, application_id, sender_id, sender_type, content, created_at, read_at

2. **progress_updates** (進捗更新)
   - id, application_id, milestone_title, progress_percentage, note, updated_by, created_at

3. **deliverables** (納品物)
   - id, application_id, title, file_url, submitted_by, submitted_at, status, reviewed_at, review_comment

### 既存テーブルの変更

- **applications**: 
  - `company_completed_at` (企業側完了日時)
  - `student_completed_at` (学生側完了日時)
  - `both_completed_at` (双方完了日時)

## UI/UXの改善

### ダッシュボード

**企業側**:
- マッチング成立セクションに「チャットで連絡」ボタンを追加 ✅
- 「進捗を確認」ボタンを追加 ✅
- 完了フローの改善（双方の完了確認）

**学生側**:
- 同様のUIを実装
- 進捗更新機能
- 納品物提出機能

### チャット画面

- タイミー風のチャットUI
- メッセージ送信フォーム
- リアルタイム更新
- メッセージ履歴の無限スクロール

### 進捗画面

- マイルストーン一覧
- 進捗率の可視化
- 納品物一覧
- 完了確認ボタン

## 次のステップ

1. **チャット機能の実装**を開始
2. **完了フローの改善**を並行して実装
3. **進捗トラッキング機能**を実装
4. **通知機能**を実装

